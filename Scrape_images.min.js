javascript:var START_PAGE=1,END_PAGE=27,TIME_BETWEEN_PAGE_DOWNLOADS_MS=2e3,TIME_AFTER_CLICK_MS=200,SCROLL_VIEW_CLASS_NAME="vue-recycle-scroller wide-scroll ready direction-vertical",PAGE_BUTTONS_CLASS_NAME="item page-nav-item",PAGE_NUMBER_ATTRIBUTE_NAME="position";async function getPages(e,o){var a=Number(document.getElementsByClassName(PAGE_BUTTONS_CLASS_NAME)[0].offsetHeight),n=5*a;function r(e){return e.toString(16).padStart(2,"0")}console.time("get-page-buttons");var s=document.getElementsByClassName(SCROLL_VIEW_CLASS_NAME)[0],l={},i=new Set;async function c(e){pageButtonsArray=new Array(...document.getElementsByClassName(PAGE_BUTTONS_CLASS_NAME));for(var t=0;t<pageButtonsArray.length;t++){var o=pageButtonsArray[t].getAttribute(PAGE_NUMBER_ATTRIBUTE_NAME);await Promise((e=>{}));i.has(o)||i.add(o)}return e}var u=o*a;u>s.scrollHeight&&(u=s.scrollHeight);for(var g=[],m=(e-1)*a;m<=u;m+=n)g.push(new Promise((e=>{t=setTimeout((function(t,o,a){console.log(o),t.scrollTo(0,o),a=c(a),console.log(a),e()}),m/n*200,s,m,l),console.log("setTimeout "+t+" for scrollTo: "+m)})));function E(e){return Object.keys(e).reduce((function(e,t){return Number(e)<Number(t)?Number(e):Number(t)}))}function d(e){return Object.keys(e).reduce((function(e,t){return Number(e)>Number(t)?Number(e):Number(t)}))}await Promise.all(g),console.timeEnd("get-page-buttons"),console.time("calculate-page-rage");var _=E(l),A=d(l);if(e<_)throw new Error("Must set startpage to a value >= to "+_);if(o>A)throw new Error("Must set endpage to a value <= to "+o);console.log("Loaded "+Object.keys(l).length+" page(s). Range loaded is "+E(l)+" to "+d(l)),console.timeEnd("calculate-page-rage"),console.time("print-pages"),console.log("Printing page(s) "+e+" to "+o);var N,p,T=(p=new Uint8Array((N||40)/2),window.crypto.getRandomValues(p),Array.from(p,r).join("")),f=[];for(const t in l)iasnum=Number(t),iasnum>=e&&iasnum<=o&&f.push([iasnum,l[t],0]);function S(e,t,o,a,n,r){console.time("load-page-"+e),console.log("Loading page: "+e),t.click(),t2=setTimeout(v,TIME_AFTER_CLICK_MS,e,t,o,a,n,r),console.log("setTimeout "+t2+" for click: "+e)}function v(e,t,o,a,n,r){canvas=document.getElementsByTagName("canvas")[0],console.timeEnd("load-page-"+e),canvas&&!function(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,result=e.toDataURL()===t.toDataURL(),t.remove(),result}(canvas)?(console.time("download-page-"+e),function(e,t,o){var a="image/png",n=a.split("/")[1];console.log("Downloading page: "+o);var r=e.toDataURL(a),s=document.createElement("a");s.id=t,s.download=t+"."+n,s.href=r,s.click(),s.remove()}(canvas,a+"-"+Number(e).toString().padStart(2,"0"),e),console.timeEnd("download-page-"+e)):o>5?console.error("No data for page: "+e+" after "+o+" attempts. Not retrying."):(console.error("No data for page: "+e+" attempt: "+o+". Will retry download..."),n.unshift([e,t,o+1])),r()}for(;f.length;){var[w,h,y]=f.shift();await new Promise((e=>{t=setTimeout(S,TIME_BETWEEN_PAGE_DOWNLOADS_MS,w,h,y,T,f,e),console.log("setTimeout "+t+" for page: "+w)}))}console.timeEnd("print-pages")}getPages(START_PAGE,END_PAGE);
